# 第一次模拟

## 模型建立与求解

记$t_{k}$时刻种群数量分布向量
$$
x^{(k)}=\left[\begin{array}{ccc}x_1^{(k)},x_2^{(k)},\cdots,x_n^{(k)}\end{array}\right]^\mathrm{T},\quad k=0 ,1 ,2 ,\cdots
$$

则初始时刻种群数量分布向量为
$$
x^{(0)}=\left[\begin{array}{cc}x_1^{(0)},x_2^{(0)},\cdots,x_n^{(0)}\end{array}\right]^\mathrm{T}
$$

$t_{k}$时刻种群中第一个年龄组的数量等于$t_{k-1}$时刻各年龄组产下所有雌性幼体的总和
$$
x_1^{(\:k)}=a_1x_1^{(\:k-1\:)}+a_2x_2^{(\:k-1\:)}+\cdots+a_nx_n^{(\:k-1\:)}\:,\quad k=0 ,1 ,2 ,\cdots
$$
$t_{k}$时刻第$i+1$个年龄组中雌性奶牛的数量等于$t_{k-1}$时刻第$i$个年龄组中存活下来的雌性奶牛的数量
$$
x_{i+1}^{(k)}=b_{i}x_{i}^{(k-1)}\:,\quad i=1\:,2\:,\cdots,n-1\
$$

遍历上述$n-1$个存活条件，并在最初添加繁殖条件，有
$$
\begin{cases}
x_1^{(k)}=a_1x_1^{(k-1)}+a_2x_2^{(k-1)}+\cdots+a_nx_n^{(k-1)}\:,\\x_2^{(k)}=b_1x_1^{(k-1)}\:,\\x_3^{(k)}=b_2x_2^{(k-1)}\:,\\\vdots\\x_n^{(k)}=b_{n-1}x_{n-1}^{(k-1)}\:.
\end{cases}
$$



记上述等式右端系数矩阵为L，即
$$
L=
\begin{bmatrix}
a_1 & a_2 & \cdots & a_{n-1} & a_n
\\b_1&0&\cdots&0&0\\0&b_2&\cdots&0&0\\\vdots&\vdots&&\vdots&\vdots\\0&0&\cdots&b_{n-1}&0
\end{bmatrix}
$$

则$t_{k}$时刻种群数量分布向量递推公式为
$$
x^{(k)}=Lx^{(k-1)} ,\quad k=1 ,2 ,\cdots
$$

由上式得，
$$
x^{(1)}=Lx^{(0)},\\x^{(2)}=Lx^{(1)}=L^{2}x^{(0)},\\\vdots\\x^{(k)}=Lx^{(k-1)}=L^{k}x^{(0)} ,\quad k=1 ,2 ,\cdots
$$
本题初始种群数量分布向量为
$$
\mathbf{x^{(0)}} = 
\begin{bmatrix}
10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10
\end{bmatrix}^\mathrm{T}
$$

子代雌雄个体总莱斯利矩阵为
$$
\mathbf{L^{'}} = 
\begin{bmatrix}
0 & 0 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

子代为雌性的几率为0.5,则雌性个体莱斯利矩阵为
$$
\mathbf{L} = 
\begin{bmatrix}
0 & 0 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

<div style="page-break-after: always;"></div>

### 小公牛

$t_{k}$时刻出售小公牛所得金额 =  $ t_{k}$时刻出售小公牛数量  $\times$ 一只小公牛的价格

$$
c^{(k)}_{小公牛} = x^{(k-1)} \times L \times y_{1}\times 30
$$

其中
$$
y_{1} = 
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即待出售小公牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{小公牛} = 30 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{1} \times r)
$$

<div style="page-break-after: always;"></div>

### 小母牛

$$
c^{(k)}_{小母牛} = x^{(k-1)} \times L \times y_{1} \times r \times 40
$$

其中
$$
y_{1} \times r = 
\begin{bmatrix}
r & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$
目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即小母牛的数量, $r$为出售小母牛的比例
则 $ x^{(k-1)} \times L \times y_{1} \times r$ 即为待出售小母牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{小母牛} = 40 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{1} \times r)
$$

<div style="page-break-after: always;"></div>

### 老母牛

$$
c^{(k)}_{老母牛} = x^{(k-1)} \times L \times y_{12} \times 120
$$
其中
$$
y_{12} = 
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$
目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出最后一个元素，即待出售老母牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{老母牛} = 120 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{12})
$$

<div style="page-break-after: always;"></div>

### 产奶牛

$$
c^{(k)}_{产奶牛} = \sum_{i=3}^{12} x^{(k-1)} × L \times y_{3,12} × 370
$$
其中
$$
y_{3,12} \times r = 
\begin{bmatrix}
0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第三至第十二个元素，即为能正常产奶的奶牛数量
$$
c_{产奶牛} = \sum_{k=0}^{5} \sum_{i=3}^{12} x^{(k-1)}_{i} × L \times y_{3,12} × 370
$$

<div style="page-break-after: always;"></div>

### 贷款

设总贷款金额为$M$,贷款金额全部用于投资,此时，有
$$
\sum_{i=1}^{12} x^{k} \leq \frac{M}{200}+130, k = 0,...,5
$$

至于还款,要求等额还款,市面上流行的还款方式为等额本金还款及等额本息还款，但仅有后者可保证每年还款数额固定不变，故确定还款方式为等额本息还款
有，
$$
\text{每年应还额度} = \frac{贷款本金 \times 年利率 \times (1 + 年利率)^{还款年数}}{(1 + 年利率)^{还款年数} - 1}
$$
则，每年还款额度 $d$ 计算公式如下
$$
d = \frac{M \times 0.15 \times (1 + 0.15)^{10}}{(1 + 0.15)^{10} - 1}
$$

<div style="page-break-after: always;"></div>

### 饲料

设牧草，甜菜，粮食种植所需土地分别为 $\alpha英亩,\beta英亩,\gamma英亩$
由题意知，每头小母牛需要$\frac{2}{3}$英亩的土地养活它，每头大母牛需要1英亩的土地养活它，然每头奶牛除了吃牧草以外，每年还需要0.6吨粮食和0.7吨甜菜. 即现有的200英亩土地分配$\beta英亩,\gamma英亩$分别种植甜菜和粮食外，剩余$\alpha$英亩土地均布满牧草

#### 对牧草($\alpha$)

$$
\alpha = \sum_{i=1}^{2} x_{i} \times \frac{2}{3} + \sum_{i=2}^{12} x_{i} \times 1
$$

#### 对粮食($\beta$)

$$
\beta = \beta_{1} + \beta_{2} + \beta_{3} + \beta_{4}\\

\text{procut}_{粮食} = 1.1 \times \beta_{1} + 0.9 \times \beta_{2} + 0.8 \times \beta_{3} + 0.6 \times \beta_{4}\\
if \quad \text{procut}_{粮食} \geq 0.6 \times \sum_{i=2}^{12} x_{i}\\
then \quad (\text{procut}_{粮食} - 0.6 \times \sum_{i=2}^{12} x_{i}) \times 75 \\
if \quad \text{procut}_{粮食} \leq 0.6 \times \sum_{i=2}^{12} x_{i}\\
then \quad (0.6 \times \sum_{i=2}^{12} x_{i} -\text{procut}_{粮食}) \times 90 \\

\beta_{1} \leq 20\\
\beta_{2} \leq 30\\
\beta_{3} \leq 30\\
\beta_{4} \leq 10
$$

#### 对甜菜($\gamma$)

$$
\text{procut}_{甜菜} = 1.5 \times \gamma\\
if \quad \text{procut}_{甜菜} \geq 0.7 \times \sum_{i=2}^{12} x_{i}\\
then \quad (\text{procut}_{甜菜} - 0.7 \times \sum_{i=2}^{12} x_{i}) \times 58 \\
if \quad \text{procut}_{甜菜} \leq 0.7 \times \sum_{i=2}^{12} x_{i}\\
then \quad (0.7 \times \sum_{i=2}^{12} x_{i} - \text{procut}_{甜菜}) \times 70 \\
$$

#### 对整体

$$
\alpha + \beta + \gamma \leq 200
$$

<div style="page-break-after: always;"></div>

### 时间

$$
t_{饲养小母牛} = \sum_{i=1}^{2} x_{i}^{k} \times 10 \\
t_{饲养大母牛} = \sum_{i=3}^{12} x_{i}^{k} \times 42 \\
t_{\beta} = \alpha \times 4 \\
t_{\gamma} = \beta \times 14 \\
t = t_{饲养小母牛} + t_{饲养大母牛} + t_{\beta} + t_{\gamma} \\
if \quad t \leq 5500 \\
then\quad cost = 4000 \\
if \quad t \geq 5500 \\
then \quad cost = 4000 + (t-5500) \times 1.2
$$

<div style="page-break-after: always;"></div>

### 资金

$$
cost_{饲养小母牛} = 500 \times \sum_{i=1}^{2} x_{i}^{(k)} \\
cost_{饲养大母牛} = 100 \times \sum_{i=3}^{12} x_{i}^{(k)} \\
cost_{\beta} = \beta \times 15\\
cost_{\gamma} = \gamma \times 10
$$