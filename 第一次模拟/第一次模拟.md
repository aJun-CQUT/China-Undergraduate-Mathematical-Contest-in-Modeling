## 模型建立与求解

记$t_{k}$时刻种群数量分布向量
$$
x^{(k)}=\left[\begin{array}{ccc}x_1^{(k)},x_2^{(k)},\cdots,x_n^{(k)}\end{array}\right]^\mathrm{T},\quad k=0 ,1 ,2 ,\cdots
$$

则初始时刻种群数量分布向量为
$$
x^{(0)}=\left[\begin{array}{cc}x_1^{(0)},x_2^{(0)},\cdots,x_n^{(0)}\end{array}\right]^\mathrm{T}
$$

$t_{k}$时刻种群中第一个年龄组的数量等于$t_{k-1}$时刻各年龄组产下所有雌性幼体的总和
$$
x_1^{(\:k)}=a_1x_1^{(\:k-1\:)}+a_2x_2^{(\:k-1\:)}+\cdots+a_nx_n^{(\:k-1\:)}\:,\quad k=0 ,1 ,2 ,\cdots
$$
$t_{k}$时刻第$i+1$个年龄组中雌性奶牛的数量等于$t_{k-1}$时刻第$i$个年龄组中存活下来的雌性奶牛的数量
$$
x_{i+1}^{(k)}=b_{i}x_{i}^{(k-1)}\:,\quad i=1\:,2\:,\cdots,n-1\
$$

遍历上述$n-1$个存活条件，并在最初添加繁殖条件，有
$$
\begin{cases}
x_1^{(k)}=a_1x_1^{(k-1)}+a_2x_2^{(k-1)}+\cdots+a_nx_n^{(k-1)}\:,\\x_2^{(k)}=b_1x_1^{(k-1)}\:,\\x_3^{(k)}=b_2x_2^{(k-1)}\:,\\\vdots\\x_n^{(k)}=b_{n-1}x_{n-1}^{(k-1)}\:.
\end{cases}
$$



记上述等式右端系数矩阵为L，即
$$
L=
\begin{bmatrix}
a_1 & a_2 & \cdots & a_{n-1} & a_n
\\b_1&0&\cdots&0&0\\0&b_2&\cdots&0&0\\\vdots&\vdots&&\vdots&\vdots\\0&0&\cdots&b_{n-1}&0
\end{bmatrix}
$$

则$t_{k}$时刻种群数量分布向量递推公式为
$$
x^{(k)}=Lx^{(k-1)} ,\quad k=1 ,2 ,\cdots
$$

由上式得，
$$
x^{(1)}=Lx^{(0)},\\x^{(2)}=Lx^{(1)}=L^{2}x^{(0)},\\\vdots\\x^{(k)}=Lx^{(k-1)}=L^{k}x^{(0)} ,\quad k=1 ,2 ,\cdots
$$
本题初始种群数量分布向量为
$$
\mathbf{x^{(0)}} = 
\begin{bmatrix}
10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10
\end{bmatrix}^\mathrm{T}
$$

子代雌雄个体总莱斯利矩阵为
$$
\mathbf{L^{'}} = 
\begin{bmatrix}
0 & 0 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

子代为雌性的几率为0.5,则雌性个体莱斯利矩阵为
$$
\mathbf{L} = 
\begin{bmatrix}
0 & 0 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

<div style="page-break-after: always;"></div>

### 小公牛

$t_{k}时刻出售小公牛所得金额$ =  $ t_{k}时刻出售小公牛数量 \times 一只小公牛的价格$

$$
c^{(k)}_{小公牛} = x^{(k-1)} \times L \times y_{1}\times 30
$$

其中
$$
y_{1} = 
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即待出售小公牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{小公牛} = 30 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{1} \times r)
$$

<div style="page-break-after: always;"></div>

### 小母牛

$$
c^{(k)}_{小母牛} = x^{(k-1)} \times L \times y_{1} \times r \times 40
$$

其中
$$
y_{1} \times r = 
\begin{bmatrix}
r & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$
目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即小母牛的数量, $r$为出售小母牛的比例
则 $ x^{(k-1)} \times L \times y_{1} \times r$ 即为待出售小母牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{小母牛} = 40 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{1} \times r)
$$

<div style="page-break-after: always;"></div>

### 老母牛

$$
c^{(k)}_{老母牛} = x^{(k-1)} \times L \times y_{12} \times 120
$$
其中
$$
y_{12} = 
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$
目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出最后一个元素，即待出售老母牛的数量
$$
\sum_{k=1}^{5} c^{(k)}_{老母牛} = 120 \sum_{k=1}^{5} (x^{(k-1)} \times L \times y_{12})
$$

<div style="page-break-after: always;"></div>

### 产奶牛

$$
c^{(k)}_{产奶牛} = \sum_{i=3}^{12} x^{(k-1)} × L \times y_{3,12} × 370
$$
其中
$$
y_{3,12} \times r = 
\begin{bmatrix}
0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第三至第十二个元素，即为能正常产奶的奶牛数量
$$
c_{产奶牛} = \sum_{k=0}^{5} \sum_{i=3}^{11} x^{(k-1)}_{i} × L \times y_{3,12} × 370
$$

<div style="page-break-after: always;"></div>

### 限制

$$
\sum_{i=1}^{2} x_{i} \times \frac{2}{3} + \sum_{i=2}^{12} x_{i} \times 1 \leq 200
$$

<div style="page-break-after: always;"></div>

### 贷款

$$
\sum_{i=1}^{12} x^{k} \leq \frac{M}{200}+130, k = 0,...,5
$$