# 第一次模拟训练A题

## 符号变量

| 符号变量                 | 含义                                         |
| :------------------------- | :------------------------------------------- |
| $ a_{i} $               | 第 $i$ 个年龄段的生育率          |
| $ b_{i} $               | 第 $i$ 个年龄段的存活率            |
| $ \mathbf{x^{(k)}} $               | 第 $ t_k $时刻种群数量分布向量            |
| $ \mathbf{x^{(0)}} $      | 初始种群数量分布向量                         |
| $ x_{i}^{(k)} $         | 第 $ t_k $时刻第 $ i $个年龄组的数量 |
| $ \mathbf{L^{'}} $        | 子代雌雄个体总莱斯利矩阵                     |
| $ \mathbf{L} $            | 雌性个体莱斯利矩阵                           |
| $ \mathbf{y}_{1} $        | 选择矩阵，用于提取第一个元素                 |
| $ \mathbf{y}_{12} $       | 选择矩阵，用于提取最后一个元素               |
| $ \mathbf{y}_{3,12} $       | 选择矩阵，用于提取第三个至最后一个元素               |
| $ r $                     | 小母牛出售的比例                           |
| $ w^{(k)}_{小公牛} $     | 第 $ t_k $时刻出售小公牛所得金额          |
| $ w^{(k)}_{小母牛} $     | 第 $ t_k $时刻出售小母牛所得金额          |
| $ w^{(k)}_{老母牛} $     | 第 $ t_k $时刻出售老母牛所得金额          |
| $ w^{(k)}_{大母牛} $     | 第 $ t_k $时刻大母牛所得金额              |
| $ M $                     | 总贷款金额                                   |
| $ m $                     | 每年还款额度                                 |
| $ \alpha $                | 牧草种植所需土地面积（英亩），也指牧草        |
| $ \beta $                 | 粮食种植所需土地面积（英亩），也指粮食        |
| $ \gamma $                | 甜菜种植所需土地面积（英亩），也指甜菜         |
| $ q_{\beta} $  | 粮食的产量                                   |
| $ q_{\gamma}  $  | 甜菜的产量                                   |
| $ t_{\beta} $             | 种植粮食所需时间                             |
| $ t_{\gamma} $            | 种植甜菜所需时间                             |
| $ t_{小母牛} $        | 饲养小母牛所需时间                           |
| $ t_{大母牛} $        | 饲养大母牛所需时间                           |
| $ t $                     | 总时间                                       |
| $ c_{\beta} $          | 种植粮食的成本                               |
| $ c_{\gamma} $         | 种植甜菜的成本                               |
| $ c_{小母牛} $     | 饲养小母牛的成本                             |
| $ c_{大母牛} $     | 饲养大母牛的成本                             |
| $ c $                  | 总成本                                       |

## 独立参数

| 符号变量                 | 含义                                         |
| :------------------------- | :------------------------------------------- |
| $ r $                     | 小母牛出售的比例                           |
| $ M $                     | 总贷款金额                                   |
| $ \alpha $                | 牧草种植所需土地面积（英亩），也指牧草        |
| $ \beta $                 | 粮食种植所需土地面积（英亩），也指粮食        |
| $ \gamma $                | 甜菜种植所需土地面积（英亩），也指甜菜         |
| $ t_{\beta} $             | 种植粮食所需时间                             |
| $ t_{\gamma} $            | 种植甜菜所需时间                             |

## 模型建立与求解

记$t_{k}$时刻种群中雌性(下文同)各年龄段数量分布向量

$$
\mathbf{x^{(k)}} = 
\begin{bmatrix}
x_1^{(k)} & x_2^{(k)}& \cdots & x_n^{(k)}
\end{bmatrix}^\mathrm{T}, \quad k = 0, 1, 2, \ldots
$$

则初始时刻种群数量分布向量为

$$
\mathbf{x^{(0)}} = 
\begin{bmatrix}
x_1^{(0)} & x_2^{(0)} & \cdots & x_n^{(0)}
\end{bmatrix}^\mathrm{T}
$$

当不出售第一个年龄段小母牛，$t_{k}$时刻种群中第一个年龄组的数量等于$t_{k-1}$时刻各年龄组产下所有雌性幼体的总和

$$
x_1^{(\:k\:)}=a_1x_1^{(\:k-1\:)}+a_2x_2^{(\:k-1\:)}+\cdots+a_nx_n^{(\:k-1\:)}\:,\quad k=0 ,1 ,2 ,\cdots
$$

当$t_{k}$时刻出售$r$比例的小母牛，即出售小母牛的数量为$x_{1}^{(k)} \times r，(k ≠ 0)$ , 由此更新第一个年龄段种群雌性数量的迭代公式如下
$$
x_1^{(k)} = a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)} -  x_1^{(k)} \times r \\
\text{即, } x_1^{(k)}(1+r) = a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)} \\
\text{也即, } x_1^{(k)} = \frac{a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)}}{(1+r)}
$$

$t_{k}$时刻第$i+1$个年龄组中雌性奶牛的数量等于$t_{k-1}$时刻第$i$个年龄组中存活下来的雌性奶牛的数量，
$$
x_{i+1}^{(k)}=b_{i}x_{i}^{(k-1)}\:,\quad i=1\:,2\:,\cdots,n-1\
$$
遍历上述$n-1$个存活条件，并在最初添加种群数量的繁殖条件公式，有
$$
\begin{cases}
x_1^{(k)} = \frac{a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)}}{(1+r)} \:, \\
x_2^{(k)}=b_1x_1^{(k-1)}\:, 
\\x_3^{(k)}=b_2x_2^{(k-1)}\:, \\
\vdots \\
x_n^{(k)}=b_{n-1}x_{n-1}^{(k-1)}\:.
\end{cases}
$$

记上述等式右端系数矩阵为L，即

$$
\mathbf{L}=
\begin{bmatrix}
\frac{a_{1}}{1+r} & \frac{a_{2}}{1+r} & \cdots & \frac{a_{n-1}}{1+r} & \frac{a_n}{1+r}
\\b_1 & 0 &\cdots & 0 & 0 \\
0 & b_2 &\cdots & 0 & 0 \\
\vdots & \vdots & &\vdots & \vdots \\
0 & 0 & \cdots & b_{n-1} & 0
\end{bmatrix} \\
$$

即，
$$
\mathbf{L}=\frac{1}{1+r}
\begin{bmatrix}
a_1 & a_2 & \cdots & a_{n-1} & a_n
\\b_1 & 0 &\cdots & 0 & 0 \\
0 & b_2 &\cdots & 0 & 0 \\
\vdots & \vdots & &\vdots & \vdots \\
0 & 0 & \cdots & b_{n-1} & 0
\end{bmatrix}
$$
则$t_{k}$时刻种群数量分布向量递推公式为
$$
\mathbf{x^{(k)}} = \mathbf{L} x^{(k-1)} ,\quad k=1 ,2 ,\cdots
$$

由上式得，

$$
\mathbf{x}^{(1)} = \mathbf{L} \mathbf{x}^{(0)},\\
\mathbf{x}^{(2)}= \mathbf{L} \mathbf{x}^{(1)}= \mathbf{L}^{2} \mathbf{x}^{(0)},\\
\vdots\\
\mathbf{x}^{(k)} = \mathbf{L} \mathbf{x}^{(k-1)}= \mathbf{L}^{k} \mathbf{x}^{(0)} ,\quad k=1 ,2 ,\cdots
$$

本题初始种群数量分布向量为

$$
\mathbf{x^{(0)}} = 
\begin{bmatrix}
10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10 & 10
\end{bmatrix}^\mathrm{T}
$$

种群数量分布莱斯利雌雄总矩阵为

$$
\mathbf{L^{''}} = 
\begin{bmatrix}
0 & 0 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 & 1.1 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

子代为雌性的几率为0.5,则种群数量分布莱斯利雌矩阵为

$$
\mathbf{L'} = 
\begin{bmatrix}
0 & 0 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$

考虑第一个年龄段的雌性出售比率为$r$ , 种群数量分布莱斯利雌矩阵应更新为
$$
\mathbf{L} = 
\frac{1}{1+r}\begin{bmatrix}
0 & 0 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 & 0.55 \\
0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.95 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.98 & 0 \\
\end{bmatrix}
$$


### 小公牛

$t_{k}$时刻出售小公牛所得金额 =  $ t_{k}$时刻出售小公牛数量  $\times$ 一只小公牛的价格

$$
w^{(k)}_{小公牛} = \mathbf{x}^{(k-1)} L \mathbf{y}_{1} \times 30
$$

其中

$$
y_{1} = 
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即为待出售的小公牛的数量

$$
\sum_{k=1}^{5} w^{(k)}_{小公牛} = 30 \sum_{k=1}^{5} (\mathbf{x}^{(k-1)}  \mathbf{L}  \mathbf{y}_{1} \times r)
$$

### 小母牛

$$
w^{(k)}_{小母牛} = \mathbf{x}^{(k-1)} L \mathbf{y}_{1} \times 40
$$

其中

$$
y_{1} \times r = 
\begin{bmatrix}
r & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第一个元素，即小母牛的数量, $r$为出售小母牛的比例
则 $ x^{(k-1)} \times L \times y_{1} \times r$ 即为待出售小母牛的数量
$$
\sum_{k=1}^{5} w^{(k)}_{小母牛} = 40 \sum_{k=1}^{5} (\mathbf{x}^{(k-1)} L \mathbf{y}_{1} \times r)
$$

### 老母牛

$$
w^{(k)}_{老母牛} = \mathbf{x}^{(k-1)} L \mathbf{y}_{12} \times 120
$$

其中

$$
y_{12} = 
\begin{bmatrix}
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出最后一个元素，即待出售老母牛的数量

$$
\sum_{k=1}^{5} w^{(k)}_{老母牛} = 120 \sum_{k=1}^{5} (\mathbf{x}^{(k-1)} L \mathbf{y}_{12})
$$

### 大母牛

$$
w^{(k)}_{大母牛} = \mathbf{x}^{(k-1)} L \mathbf{y}_{3,12} \times 370
$$
其中
$$
y_{3,12} \times r = 
\begin{bmatrix}
0 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1
\end{bmatrix}
$$

目的为从前面所得的种群数量分布向量（$x^{(k-1)} \times L$）中取出第三至第十二个元素，即为能正常产奶的奶牛数量

$$
c_{大母牛} = 370 \sum_{k=0}^{5} \mathbf{x}^{(k-1)} L \mathbf{y}_{3,12}
$$

### 贷款

设总贷款金额为$M$,贷款金额全部用于投资,此时，有

$$
\sum_{i=1}^{12} x^{(\:k\:)} \leq \frac{M}{200}+130, k = 0,...,5
$$

至于还款,要求等额还款,市面上流行的还款方式为等额本金还款及等额本息还款，但仅有后者可保证每年还款数额固定不变，故确定还款方式为等额本息还款
有，
$$
\text{每年应还额度} = \frac{贷款本金 \times 年利率 \times (1 + 年利率)^{还款年数}}{(1 + 年利率)^{还款年数} - 1}
$$

则，每年还款额度 $m$ 计算公式如下

$$
m = \frac{M \times 0.15 \times (1 + 0.15)^{10}}{(1 + 0.15)^{10} - 1}
$$

### 饲料

设牧草，甜菜，粮食种植所需土地分别为 $\alpha英亩,\beta英亩,\gamma英亩$
由题意知，每头小母牛需要$\frac{2}{3}$英亩的土地养活它，每头大母牛需要1英亩的土地养活它，然每头奶牛除了吃牧草以外，每年还需要0.6吨粮食和0.7吨甜菜. 即现有的200英亩土地分配$\beta英亩,\gamma英亩$分别种植甜菜和粮食外，剩余$\alpha$英亩土地均布满牧草

#### 对牧草($\alpha$)

$$
\alpha = \sum_{i=1}^{2} x_{i} \times \frac{2}{3} + \sum_{i=2}^{12} x_{i} \times 1
$$

#### 对粮食($\beta$)

$$
\beta = \beta_{1} + \beta_{2} + \beta_{3} + \beta_{4}\\

q_{\beta} = 1.1 \times \beta_{1} + 0.9 \times \beta_{2} + 0.8 \times \beta_{3} + 0.6 \times \beta_{4}\\
if \quad q_{\beta} \geq 0.6 \times \sum_{i=2}^{12} x_{i}\\
then \quad (q_{\beta} - 0.6 \times \sum_{i=2}^{12} x_{i}) \times 75 \\
if \quad q_{\beta} \leq 0.6 \times \sum_{i=2}^{12} x_{i}\\
then \quad (0.6 \times \sum_{i=2}^{12} x_{i} -\text{q}_{粮食}) \times 90 \\

\beta_{1} \leq 20\\
\beta_{2} \leq 30\\
\beta_{3} \leq 30\\
\beta_{4} \leq 10
$$

#### 对甜菜($\gamma$)

$$
q_{\gamma}  = 1.5 \times \gamma\\
if \quad q_{\gamma}  \geq 0.7 \times \sum_{i=2}^{12} x_{i}\\
then \quad (q_{\gamma}  - 0.7 \times \sum_{i=2}^{12} x_{i}) \times 58 \\
if \quad q_{\gamma}  \leq 0.7 \times \sum_{i=2}^{12} x_{i}\\
then \quad (0.7 \times \sum_{i=2}^{12} x_{i} - q_{\gamma} ) \times 70 \\
$$

#### 对整体

$$
\alpha + \beta + \gamma \leq 200
$$

### 时间

$$
t_{小母牛} = \sum_{i=1}^{2} x_{i}^{k} \times 10 \\
t_{大母牛} = \sum_{i=3}^{12} x_{i}^{k} \times 42 \\
t_{\beta} = \alpha \times 4 \\
t_{\gamma} = \beta \times 14 \\
t = t_{小母牛} + t_{大母牛} + t_{\beta} + t_{\gamma} \\
if \quad t \leq 5500 \\
then\quad c = 4000 \\
if \quad t \geq 5500 \\
then \quad c = 4000 + (t-5500) \times 1.2
$$

### 资金

$$
c_{小母牛} = 500 \times \sum_{i=1}^{2} x_{i}^{(k)} \\
c_{大母牛} = 100 \times \sum_{i=3}^{12} x_{i}^{(k)} \\
c_{\beta} = \beta \times 15\\
c_{\gamma} = \gamma \times 10
$$